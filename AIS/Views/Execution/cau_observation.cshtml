@{
    var page_id = ViewData["PageId"] as int? ?? 0;
}

@{
    ViewData["Title"] = "CAU Observation";
    Layout = "_Layout";
}

<style type="text/css">
    label.heading {
        font-weight: bold;
    }
    .action-col {
        width: 1%;
        white-space: nowrap;
    }
</style>


<script type="text/javascript">
    var g_engId = 0;
    var g_respUser = [];
    var g_stagedResp = [];
    var g_selectedRespRow = null;
    var g_selectedRiskId = 0;
    var g_annexList = @Json.Serialize(ViewData["AnnexList"]);

    function normalizeRequiredInt(value) {
        var trimmed = $.trim(value);
        if (!trimmed) {
            return 0;
        }
        var number = parseInt(trimmed, 10);
        return Number.isNaN(number) ? 0 : number;
    }

    function normalizeNullableInt(value) {
        var trimmed = $.trim(value);
        if (!trimmed) {
            return null;
        }
        var number = parseInt(trimmed, 10);
        return Number.isNaN(number) ? null : number;
    }
    $('#document').ready(function () {
        var url_string = window.location;
        var url = new URL(url_string);
        g_engId = url.searchParams.get("engId");
        $('#template_box').richText({
            bold: true,
            italic: true,
            underline: true,
            leftAlign: true,
            centerAlign: true,
            rightAlign: true,
            justify: true,
            ol: true,
            ul: true,
            heading: true,
            fonts: true,
            fontColor: true,
            fontSize: true,
            table: true,
            removeStyles: true,
            code: true,
            imageUpload: false,
            fileUpload: false,
            videoEmbed: false,
            urls: false
        });

        $('#updatedAnnexlist').select2();
        $('#riskActivitiesSelectBox').select2();
        $('#updatedAnnexlist').on('change', updateRiskDisplay);

         document.getElementById('amount_inv_field').addEventListener('input', function (e) {
        this.value = this.value.replace(/\D|^0(?=\d)/g, ''); // Removes decimals and leading zeros
    });

    });

    function buildRespKey(ppNo, role, loanCase, accountNumber) {
        return `${ppNo || ''}|${role || ''}|${loanCase || ''}|${accountNumber || ''}`;
    }

    function renderPendingGrid() {
        var $tbody = $('#respPendingTable tbody');
        $tbody.empty();
        g_stagedResp.forEach(function (item) {
            $tbody.append(`
                <tr>
                    <td>${item.role || ''}</td>
                    <td>${item.ppNo || ''}</td>
                    <td>${item.empName || ''}</td>
                    <td>${item.loanCase || ''}</td>
                    <td>${item.lcAmount || ''}</td>
                    <td>${item.accountNumber || ''}</td>
                    <td>${item.accAmount || ''}</td>
                    <td class="text-center">
                        <button type="button" class="btn btn-sm btn-outline-danger respPendingRemove" data-key="${item.key}">Remove</button>
                    </td>
                </tr>
            `);
        });
    }

    function stagePending(item) {
        if (!item) {
            return;
        }
        var key = item.key || buildRespKey(item.ppNo, item.role, item.loanCase, item.accountNumber);
        item.key = key;
        var exists = g_stagedResp.some(function (entry) { return entry.key === key; });
        if (exists) {
            alert('This responsibility is already added.');
            return;
        }
        g_stagedResp.push(item);
    }

    function clearPending() {
        g_stagedResp = [];
        renderPendingGrid();
    }


    function div_risksubcategoryShowHide() {
        if ($('#riskGroupSelectBox option:selected').val() == 0) {
            $('#div_risksubcategory').hide();
            $('#div_activityContainer').hide();
        }
        else {
            $('#div_risksubcategory').show();
            $('#div_activityContainer').hide();
            $('#riskSubGroupSelectBox').empty();
            $.ajax({
                url: g_asiBaseURL + "/ApiCalls/sub_checklist",
                type: "POST",
                data: {
                    'T_ID': $('#riskGroupSelectBox option:selected').val(),
                },
                cache: false,
                success: function (data) {
                    $('#riskSubGroupSelectBox').append("<option value=\"0\" id=\"0\">--Select Sub Group--</option>");
                    $.each(data, function (index, item) {
                        $('#riskSubGroupSelectBox').append("<option value=\"" + item.s_ID + "\"> " + item.heading + " </option > ");
                    });

                },
                dataType: "json",
            });
        }
    }
    function div_activityContainerShowHide() {
        if ($('#riskSubGroupSelectBox option:selected').val() == 0)
            $('#div_activityContainer').hide();
        else
            $('#div_activityContainer').show();
        $('#riskActivitiesSelectBox').empty();
        $.ajax({
            url: g_asiBaseURL + "/ApiCalls/checklist_details",
            type: "POST",
            data: {
                'S_ID': $('#riskSubGroupSelectBox option:selected').val(),
            },
            cache: false,
            success: function (data) {
                $('#riskActivitiesSelectBox').append("<option value=\"0\" id=\"0\">--Select Sub Group--</option>");
                $.each(data, function (index, item) {
                    $('#riskActivitiesSelectBox').append("<option value=\"" + item.id + "\"> " + item.heading + "</option>");
                });

                if ($.fn.select2) {
                    if ($('#riskActivitiesSelectBox').data('select2')) {
                        $('#riskActivitiesSelectBox').select2('destroy');
                    }
                    $('#riskActivitiesSelectBox').select2();
                }
            },
            dataType: "json",
        });
    }
    function getAuditObservationTemplate() {
        if ($('#riskActivitiesSelectBox option:selected').val() == 0)
            $('#template_box').val('').trigger('change');
        else {
            $('#template_box').val('').trigger('change');
            $.ajax({
                url: g_asiBaseURL + "/Execution/audit_observation_template",
                type: "POST",
                data: {
                    'ACTIVITY_ID': $('#riskActivitiesSelectBox option:selected').val(),
                },
                cache: false,
                success: function (data) {
                    $.each(data, function (index, item) {
                        $('#template_box').val(item.obS_TEMPLATE).trigger('change');
                    });

                },
                dataType: "json",
            });
        }
    }

    function div_zoneBranchesShowHide() {
        if ($('#zoneSearchField option:selected').val() == 0) {
            $('#brSearchField').empty();
            $('#brSearchField').append('<option value="0" id="0">--Select Branch--</option>');
        }
        else {
            $('#brSearchField').empty();
            $('#brSearchField').append('<option value="0" id="0">--Select Branch--</option>')
            $.ajax({
                url: g_asiBaseURL + "/ApiCalls/GetZoneBranches",
                type: "POST",
                data: {
                    'zone_code': $('#zoneSearchField option:selected').val(),
                    'session_check':false
                },
                cache: false,
                success: function (data) {
                    $.each(data, function (index, branch) {
                        $('#brSearchField').append('<option value="' + branch.branchcode + '" id="' + branch.branchcode + '">' + branch.description + '</option>')
                    });
                },
                dataType: "json",
            });
        }
    }

    function submitObservationToAuditee() {
        if ($('#updatedAnnexlist').val() == 0) {
            alert('Select Annexure');
            return;
        }
        if ($('#riskGroupSelectBox').val() == 0) {
            alert('Select Violation Category');
            return;
        }
        if ($('#riskSubGroupSelectBox').val() == 0) {
            alert('Select Violation Nature');
            return;
        }
        if ($('#riskActivitiesSelectBox').val() == 0) {
            alert('Select Sub Checklist Detail');
            return;
        }


        updateRiskDisplay();
        if (g_selectedRiskId == 0) {
            alert('Risk not available for selected Annexure');
            return;
        }
        if ($('#viewMemo_heading').val() == 0) {
            alert('Please Enter Para Heading');
            return;
        }

        if($('#amount_inv_field').val()  == ""){
            alert('Please Enter Amount Involved, in case of blank please enter 0');

            return;
        }

         if($('#no_instances_field').val()  ==""){
            alert('Please Enter No. of Instances, in case of blank please enter 0');
            return;
        }
        var resP = [];
        $.each($('#listofRespPersons tbody tr'), function (i, v) {
            resP.push({
                'PP_NO': normalizeRequiredInt($(v).data('pp')),
                'EMP_NAME': $(v).find('td').eq(2).html(),
                'LOAN_CASE': normalizeNullableInt($(v).find('td').eq(3).html()),
                'LC_AMOUNT': normalizeNullableInt($(v).find('td').eq(4).html()),
                'ACCOUNT_NUMBER': normalizeRequiredInt($(v).find('td').eq(5).html()),
                'ACC_AMOUNT': normalizeRequiredInt($(v).find('td').eq(6).html())
            });
        });
        var g_memoObj = [];
        var memo = {
            'MEMO': $('.richText-editor').html(),
            'ID': 'obs_0',
            'HEADING': $('#viewMemo_heading').val(),
            'RISK': g_selectedRiskId,
            'ANNEXURE_ID': $('#updatedAnnexlist').val(),
            'AMOUNT_INVOLVED': $('#amount_inv_field').val(),
            'NO_OF_INSTANCES': $('#no_instances_field').val(),
            'DAYS': $('#viewMemo_replydays option:selected').val(),
            'LOANCASE': '',
            'RESPONSIBLE_PPNO': resP,
            'ATTACHMENTS': ''
        };
        g_memoObj.push(memo);
        $('#submitCAUobBtn').attr('disabled', true);
        var payload = {
            'LIST_OBS': g_memoObj,
            'ENG_ID': g_engId,
            'BRANCH_ID': $('#brSearchField').val(),
            'SUB_CHECKLISTID': $('#riskSubGroupSelectBox').val(),
            'CHECKLIST_ID': $('#riskActivitiesSelectBox').val(),
            'ANNEXURE_ID': $('#updatedAnnexlist').val()

        };
        $.ajax({
            url: g_asiBaseURL + "/ApiCalls/save_observations_cau",
            type: "POST",
            contentType: "application/json",
            data: JSON.stringify(payload),
            cache: false,
            success: function (data) {
                $('#submitCAUobBtn').attr('disabled', false);
                alert(data.message);
                onAlertCallback(reloadLocation);
            },
            dataType: "json",
        });

    }

function reloadLocation() {
        window.location.reload();
    }

    function updateRiskDisplay() {
        var annexId = $('#updatedAnnexlist').val();
        var riskName = '';
        g_selectedRiskId = 0;
        $.each(g_annexList, function (i, v) {
            var id = v.ID || v.id;
            if (id == annexId) {
                riskName = v.RISK || v.risk;
                g_selectedRiskId = v.RISK_ID || v.risK_ID;
            }
        });
        $('#viewMemo_risk_display').val(riskName);
        var color = '';
        if (riskName.toLowerCase() === 'high') {
            color = 'red';
        } else if (riskName.toLowerCase() === 'medium') {
            color = 'gold';
        } else if (riskName.toLowerCase() === 'low') {
            color = 'green';
        }
        $('#viewMemo_risk_display').css('color', color);
    }

    function openResponsiblePPs() {
        $('#ResponsiblePPModel').modal('show');
        clearPending();
        g_selectedRespRow = null;
        $('#responsibleLCNoEntryField').val('');
        $('#responsibleBrCodeEntryField').val('');
        $('#responsiblePPNoEntryField').val('');
        $('#responsibleLoanNumberEntryField').val('');
        $('#responsibleLoanAmountEntryField').val('');
        $('#responsibleAccountNumberEntryField').val('');
        $('#responsibleAccountAmountEntryField').val('');
        $('#addResponsibleButton').removeClass("d-none");
        $('#updateResponsibleButton').addClass("d-none");
        $('#deleteResponsibleButton').addClass("d-none");
        return false;
    }
  
     function getMatchedPP() {
          if ($.trim($('#responsiblePPNoEntryField').val()) === "") {
              alert("Please enter PP Number to proceed");
              return;
          }
          g_respUser = [];
          $.ajax({
              url: g_asiBaseURL + "/ApiCalls/get_responsible_by_pp",
              type: "POST",
              data: {
                  'PP_NO': normalizeRequiredInt($('#responsiblePPNoEntryField').val())
              },
              cache: false,
              success: function (data) {
                  var items = Array.isArray(data) ? data : (data ? [data] : []);
                  if (!items.length) {
                      alert("No record found..");
                      return;
                  }
                  items.forEach(function (item) {
                      var ppNo = item.ppNo || item.PP_NO || item.ppNumber || $('#responsiblePPNoEntryField').val();
                      var empName = item.name || item.empName || item.EMP_NAME || '';
                      var role = item.role || item.ROLE || item.respRole || '';
                      var loanCase = item.loanCase || item.LOAN_CASE || item.loanCaseNo || $('#responsibleLoanNumberEntryField').val();
                      var lcAmount = item.lcAmount || item.LC_AMOUNT || item.loanAmount || $('#responsibleLoanAmountEntryField').val();
                      var accountNumber = item.accountNumber || item.ACCOUNT_NUMBER || $('#responsibleAccountNumberEntryField').val();
                      var accAmount = item.accAmount || item.ACC_AMOUNT || $('#responsibleAccountAmountEntryField').val();
                      stagePending({
                          role: role,
                          ppNo: ppNo,
                          empName: empName,
                          loanCase: loanCase,
                          lcAmount: lcAmount,
                          accountNumber: accountNumber,
                          accAmount: accAmount
                      });
                  });
                  renderPendingGrid();
              },
              dataType: "json",
          });
      }

      function getLCDetails(){
        g_respUser = [];
        $.ajax({
            url: g_asiBaseURL + "/ApiCalls/get_responsible_by_lc",
            type: "POST",
            data: {
                'LC_NO': $('#responsibleLCNoEntryField').val(),
                'BR_CODE': $('#responsibleBrCodeEntryField').val()
            },
            cache: false,
            success: function (data) {
                var response = Array.isArray(data) ? data : (data ? [data] : []);
                if (!response.length) {
                    alert("No record found..");
                    return;
                }
                response.forEach(function (item) {
                    var ppNo = item.ppNo || item.PP_NO || item.ppNumber || '';
                    var empName = item.name || item.empName || item.EMP_NAME || '';
                    var role = item.role || item.ROLE || item.respRole || '';
                    var loanCase = item.loanCase || item.LOAN_CASE || item.loanCaseNo || $('#responsibleLCNoEntryField').val();
                    var lcAmount = item.lcAmount || item.LC_AMOUNT || item.outstandingAmount || '';
                    var accountNumber = item.accountNumber || item.ACCOUNT_NUMBER || item.accountNo || '';
                    var accAmount = item.accAmount || item.ACC_AMOUNT || item.accountAmount || '';
                    stagePending({
                        role: role,
                        ppNo: ppNo,
                        empName: empName,
                        loanCase: loanCase,
                        lcAmount: lcAmount,
                        accountNumber: accountNumber,
                        accAmount: accAmount
                    });
                });
                renderPendingGrid();
            },
            dataType: "json",
        });
    }

    function deleteRespRow(e) {
        if (!confirm('Are you sure you want to delete this responsibility?')) {
            return;
        }
        $(e).closest('tr').remove();
    }

    function updateRespRow(e) {
        var $row = $(e).closest('tr');
        g_selectedRespRow = $row;
        $('#ResponsiblePPModel').off('shown.bs.modal.update').on('shown.bs.modal.update', function () {
            $('#addResponsibleButton').addClass("d-none");
            $('#updateResponsibleButton').removeClass("d-none");
            $('#deleteResponsibleButton').removeClass("d-none");
            var lcNo = $.trim($row.data('loan') || $row.children('td').eq(3).text()) || '0';
            var lcAmt = $.trim($row.data('lcamount') || $row.children('td').eq(4).text()) || '0';
            var accNo = $.trim($row.data('account') || $row.children('td').eq(5).text()) || '0';
            var accAmt = $.trim($row.data('accamount') || $row.children('td').eq(6).text()) || '0';
            $('#responsiblePPNoEntryField').val($row.data('pp') || $row.children('td').eq(1).text());
            $('#responsibleLoanNumberEntryField').val(lcNo);
            $('#responsibleLoanAmountEntryField').val(lcAmt);
            $('#responsibleAccountNumberEntryField').val(accNo);
            $('#responsibleAccountAmountEntryField').val(accAmt);
            clearPending();
            stagePending({
                role: '',
                ppNo: $row.data('pp') || $row.children('td').eq(1).text(),
                empName: $row.data('emp') || $row.children('td').eq(2).text(),
                loanCase: lcNo,
                lcAmount: lcAmt,
                accountNumber: accNo,
                accAmount: accAmt
            });
            renderPendingGrid();
            $(this).off('shown.bs.modal.update');
        }).modal('show');
    }
    
      function addResponsibilityToMainTable(action) {
        if (!g_stagedResp.length && action !== 'D') {
            alert('Select at least one responsible');
            return;
        }
        if (action === 'U') {
            if (!g_selectedRespRow) {
                alert('Please select a responsibility to update.');
                return;
            }
            var item = g_stagedResp[0];
            $(g_selectedRespRow)
                .attr('data-pp', item.ppNo || '')
                .attr('data-loan', item.loanCase || '')
                .attr('data-account', item.accountNumber || '')
                .attr('data-lcamount', item.lcAmount || '')
                .attr('data-accamount', item.accAmount || '')
                .attr('data-emp', item.empName || '')
                .children('td').eq(1).text(item.ppNo || '').end()
                .children('td').eq(2).text(item.empName || '').end()
                .children('td').eq(3).text(item.loanCase || '').end()
                .children('td').eq(4).text(item.lcAmount || '').end()
                .children('td').eq(5).text(item.accountNumber || '').end()
                .children('td').eq(6).text(item.accAmount || '');
            g_selectedRespRow = null;
        } else if (action === 'D') {
            if (!g_selectedRespRow) {
                alert('Please select a responsibility to delete.');
                return;
            }
            if (confirm('Are you sure you want to delete this responsibility?')) {
                $(g_selectedRespRow).remove();
                g_selectedRespRow = null;
            }
        } else {
            g_stagedResp.forEach(function (item) {
                var srNo = $('#listofRespPersons tbody tr').length + 1;
                $('#listofRespPersons tbody').append(`
                    <tr data-pp="${item.ppNo || ''}" data-loan="${item.loanCase || ''}" data-account="${item.accountNumber || ''}" data-lcamount="${item.lcAmount || ''}" data-accamount="${item.accAmount || ''}" data-emp="${item.empName || ''}">
                        <td>${srNo}</td>
                        <td>${item.ppNo || ''}</td>
                        <td>${item.empName || ''}</td>
                        <td>${item.loanCase || ''}</td>
                        <td>${item.lcAmount || ''}</td>
                        <td>${item.accountNumber || ''}</td>
                        <td>${item.accAmount || ''}</td>
                        <td class="text-center">
                            <a href="#" onclick="event.preventDefault(); updateRespRow(this);">Update</a>
                        </td>
                        <td class="text-center">
                            <a href="#" class="text-danger" onclick="event.preventDefault(); deleteRespRow(this);">Delete</a>
                        </td>
                    </tr>
                `);
            });
        }
        clearPending();
        $('#addResponsibleButton').removeClass('d-none');
        $('#updateResponsibleButton').addClass('d-none');
        $('#deleteResponsibleButton').addClass('d-none');
        $('#ResponsiblePPModel').modal('hide');
    }

    $(document).on('click', '.respPendingRemove', function () {
        var key = $(this).data('key');
        g_stagedResp = g_stagedResp.filter(function (entry) { return entry.key !== key; });
        renderPendingGrid();
    });

</script>
<div class="row col-md-12">
    <div class="col-md-12 mt-3">
        <center class="w-100"><h3>Observation</h3></center>
        <div>
            <h5>Annexure</h5>
        </div>
        <select id="updatedAnnexlist" class="form-select form-control">
            <option selected="selected" value="0" id="0">--Select Annexure--</option>
            @{
                if (ViewData["AnnexList"] != null)
                {

                    foreach (var item in (dynamic)(ViewData["AnnexList"]))
                    {
                        <option id="@item.ID" value="@item.ID">@item.ANNEX</option>
                    }

                }
            }

        </select>
    </div>
    <div class="col-md-12 mt-3">
        <label for="viewMemo_risk_display">Risk will be assigned on the basis of Selected Annexure</label>
        <input id="viewMemo_risk_display" class="form-control" readonly />
    </div>

    <div class="col-md-12 mt-3">
        <div>
            <h5>Checklist</h5>
        </div>
        <select id="riskGroupSelectBox" onchange="div_risksubcategoryShowHide();" class="form-select form-control" aria-label="Default select example">
            <option value="0" id="0" selected="selected">--Select Voilation Category--</option>
            @{
                if (ViewData["ProcessList"] != null)
                {
                    foreach (var item in (dynamic)(ViewData["ProcessList"]))
                    {
                        <option id="@item.T_ID" value="@item.T_ID">@item.HEADING</option>
                    }
                }
            }
        </select>
    </div>
    <div id="div_risksubcategory" style="display:none;" class="col-md-12 mt-3">
        <h5>Subchecklist</h5>
        <select id="riskSubGroupSelectBox" onchange="div_activityContainerShowHide();" class="form-select form-control" aria-label="Default select example">
        </select>
    </div>
    <div id="div_activityContainer" style="display:none;" class="col-md-12 mt-3">
        <h5>Checklist Details</h5>
        <select id="riskActivitiesSelectBox" onchange="getAuditObservationTemplate();" class="form-select form-control" aria-label="Default select example">
        </select>
    </div>
    <div id="div_headingPanel" class="col-md-12 mt-3">
        <h5>Heading/Title <small class="text-muted">(A-Z, 0-9, space, &amp;, ?, comma)</small></h5>
        <input type="text" class="form-control alnum-only" id="viewMemo_heading" placeholder="Heading/Title (Alphabets, numbers, spaces, ampersand (&amp;), comma (,), and question mark (?) only)" data-allow-amp="true" data-allow-question="true" data-maxlen="500" maxlength="500" />
    </div>
    <div class="col-md-12 mt-3">
        <div class="page-wrapper box-content">
            <textarea id="template_box" class="content" name="example"></textarea>
        </div>
    </div>
    <div class="row col-sm-12">
        <div class="col-md-2 mt-3">
            <label class="font-bold text-bold heading">Responsible PP NO.</label>
        </div>

        <div class="d-flex justify-content-end mb-2">
            <button type="button" onclick="openResponsiblePPs();" class="rounded-circle btn btn-danger btn-sm" aria-label="Add responsible person">
                <i class="fa fa-plus text-white"></i>
            </button>
        </div>
        <table id="listofRespPersons" class="table table-hover table-bordered table-hover mt-3 table-striped">
            <thead style="background-color: rgb(181 229 117 / 93%) !important; ">
                <tr>
                    <th class="col-md- auto font-weight-bold">Sr.No</th>
                    <th class="col-md- auto font-weight-bold">P.P. No</th>
                    <th class="col-md- auto font-weight-bold">Name</th>
                    <th class="col-md- auto font-weight-bold">Loan Case</th>
                    <th class="col-md- auto font-weight-bold">LC Amount</th>
                    <th class="col-md- auto font-weight-bold">Account No.</th>
                    <th class="col-md- auto font-weight-bold">ACC Amount</th>
                    <th class="col-md- auto text-center font-weight-bold action-col">Update</th>
                    <th class="col-md- auto text-center font-weight-bold action-col">Delete</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
    <div class="row col-md-12">
        <div class="col-md-2 mt-3">
            <label class="font-bold text-bold heading">Amount Involved</label>
        </div>
        <div class="col-md-4 mt-3">
            <input id="amount_inv_field" type="number" class="form-control" />
        </div>
        <div class="col-md-2 mt-3">
            <label class="font-bold text-bold heading">No. of Instances</label>
        </div>
        <div class="col-md-4 mt-3">
            <input id="no_instances_field" type="number" class="form-control" />
        </div>
    </div>
    <p class="text-center text-red heading mt-3" style="font-weight:bold; color:red;">
        Please only select the branch in case you want to send this observation to branch.
        In case of forwarding/submitting the observation to Credit Administration Unit, Do Not Select any Branch
    </p>
    <div class="row col-md-12 mt-3">

        <div class="col-md-2 mt-3">
            <label class="font-bold text-bold heading">Zones</label>
        </div>
        <div class="col-md-4 mt-3">
            <select id="zoneSearchField" onchange="div_zoneBranchesShowHide();" class="form-select form-control" aria-label="Default select example">
                <option value="0" id="0" selected="selected">--Select Zone--</option>
                @{
                    if (ViewData["ZonesList"] != null)
                    {
                        foreach (var item in (dynamic)(ViewData["ZonesList"]))
                        {
                            <option id="@item.ZONECODE" value="@item.ZONECODE">@item.ZONENAME</option>
                        }
                    }
                }
            </select>
        </div>
        <div class="col-md-2 mt-3">
            <label class="font-bold text-bold heading">Branches</label>
        </div>
        <div class="col-md-4 mt-3">
            <select id="brSearchField" class="form-select form-control" aria-label="Default select example">
                <option value="0" id="0" selected="selected">--Select Branch--</option>
            </select>
        </div>

        <div class="col-md-2 mt-3">
            <label class="font-bold text-bold heading">No. of Days to Reply</label>
        </div>
        <div class="col-md-4 mt-3">
            <select class="form-control form-select">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
            </select>
        </div>
        <div class="col-md-2 mt-3">
            <label class="font-bold text-bold heading">Attachments</label>
        </div>
        <div class="col-md-4 mt-3">
            <input class="form-control" type="file" multiple="multiple" style="padding-top:3px;" />
        </div>
    </div>

    <div class="row col-md-12 mt-5">
        <button id="submitCAUobBtn" onclick="submitObservationToAuditee();" style="margin-left:20px;" class="btn btn-primary">Save Observation</button>
    </div>
</div>


<div id="ResponsiblePPModel" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" style="min-width:95% !important" role="document">
        <div class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title">Responsible Person</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">

                        <label class="form-control text-bold fw-bold text-center">Search Responsible By LC Number</label>

                        <div class="row col-sm-12">
                            <div class="col-sm-5">
                                <label for="viewMemo_memo">Loan Case No.</label>
                                <input type="text" class="form-control digits-only" id="responsibleLCNoEntryField" inputmode="numeric" pattern="[0-9]*" autocomplete="off" />
                            </div>
                            <div class="col-sm-5">
                                <label for="responsibleBrCodeEntryField">Branch Code <small class="text-muted">(0-9 only)</small></label>
                                <input type="text" class="form-control digits-only" id="responsibleBrCodeEntryField" aria-describedby="brcode" placeholder="Branch Code (digits only)" inputmode="numeric" pattern="[0-9]*" autocomplete="off" />
                            </div>
                            <div class="col-sm-2 d-flex align-items-end">
                                <button onclick="getLCDetails();" type="button" class="btn btn-danger w-100">Find</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">

                        <label class="form-control text-bold fw-bold text-center">Search Responsible By PP No.</label>

                                                <div id="findBYPPNOPanel" class="mt-2 row col-md-12">
                            <div class="col-md-2">
                                <label for="responsiblePPNoEntryField" class="form-label">PPNO</label>
                                <input id="responsiblePPNoEntryField" class="form-control digits-only" type="text" placeholder="Enter PP. No." inputmode="numeric" pattern="[0-9]*" autocomplete="off" />
                            </div>
                            <div class="col-md-2">
                                <label for="responsibleLoanNumberEntryField" class="form-label">Loan Case No</label>
                                <input id="responsibleLoanNumberEntryField" class="form-control digits-only" type="text" placeholder="Enter LC No." inputmode="numeric" pattern="[0-9]*" autocomplete="off" />
                            </div>
                            <div class="col-md-2">
                                <label for="responsibleLoanAmountEntryField" class="form-label">Loan Amount</label>
                                <input id="responsibleLoanAmountEntryField" class="form-control digits-only" type="text" placeholder="Enter LC Amount" inputmode="numeric" pattern="[0-9]*" autocomplete="off" />
                            </div>
                            <div class="col-md-2">
                                <label for="responsibleAccountNumberEntryField" class="form-label">Account No</label>
                                <input id="responsibleAccountNumberEntryField" class="form-control digits-only" type="text" placeholder="Enter Account Number" inputmode="numeric" pattern="[0-9]*" autocomplete="off" />
                            </div>
                            <div class="col-md-2">
                                <label for="responsibleAccountAmountEntryField" class="form-label">Account Amount</label>
                                <input id="responsibleAccountAmountEntryField" class="form-control digits-only" type="text" placeholder="Enter Account Amount" inputmode="numeric" pattern="[0-9]*" autocomplete="off" />
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button type="button" onclick="getMatchedPP();" class="col-md-2 btn btn-success w-100">Select</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-control text-bold fw-bold text-center">Selected Responsibles (Pending)</label>
                        <div class="table-responsive mt-2">
                            <table id="respPendingTable" class="table table-sm table-bordered">
                                <thead>
                                    <tr>
                                        <th>Role</th>
                                        <th>PP No</th>
                                        <th>Name</th>
                                        <th>Loan Case</th>
                                        <th>LC Amount</th>
                                        <th>Account No</th>
                                        <th>ACC Amount</th>
                                        <th class="text-center">Remove</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button id="addResponsibleButton" onclick="addResponsibilityToMainTable('A');" type="button" class="btn btn-danger">Add Responsibility</button>
                <button id="updateResponsibleButton" onclick="addResponsibilityToMainTable('U');" type="button" class="btn btn-success d-none">Update Responsibility</button>
                <button id="deleteResponsibleButton" onclick="addResponsibilityToMainTable('D');" type="button" class="btn btn-danger d-none">Delete Responsibility</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
